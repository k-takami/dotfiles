#Jenkins installation
#oo
  #デフォルトでは8080で起動するのでVMなどのポート割り当てでぶつからないようにしておく
  #ロケール設定はブラウザー->**->言語設定の優先順できまる

  #Windows
    # https://jenkins.io/ からexe DL

  　# exeでインストール後、画面中段に記載してあるPATHのファイルを参照して、 パスワードを入力
      >more "C:\Program Files (x86)\Jenkins\secrets\initialAdminPassword"
      e8502005794e45a9b658b4653bb49a6f
    #WORKSPACE:
    #  "C:\Program Files (x86)\Jenkins\workspace\***job_name***"
    # BACKUP & RESTORE on SYGWIN
    # $ sh jenkins-backup.sh /c/"Program Files (x86)"/Jenkins/ jenkinsBAK.tgz

  #REHL
    $ sudo wget -O /etc/yum.repos.d/jenkins.repo http://pkg.jenkins-ci.org/redhat/jenkins.repo
    $ sudo rpm --import http://pkg.jenkins-ci.org/redhat/jenkins-ci.org.key
    $ sudo yum install -y jenkins
    $ sudo cp -rp /etc/sysconfig/jenkins /etc/sysconfig/jenkins.bak
    $ sudo  vi /etc/sysconfig/jenkins
      JENKINS_PORT="8081" など適宜調整

    # http://localhost:8081/ でPassword入れてadminでログイン
      $ sudo cat /var/lib/jenkins/secrets/initialAdminPassword
        7ec5c08b38c54fe9b9e5c0af565d4ba6
    $ sudo service jenkins start
    #WORKSPACE:
    #   /var/lib/jenkins/workspace/***job_name***
    #
  #debian/UBUNTU
    # $ sudo visudo
      # jenkins ALL=(ALL) NOPASSWD:ALL
      # $ service jenkins restart  #<---これしないとlinux desktopクラッシュかも
      # 

  #git円滑化
    $ cd ~jenkins/
    $ sudo mkdir .ssh
    $ sudo chown -R jenkins .ssh
    $ sudo -u jenkins -H ssh-keygen -t rsa -C  jenkins@`hostname`
    $ sudo chmod 744 .ssh
    $ sudo chmod 700 .ssh/id_rsa
    # jenkinsでのSSH疎通確認
    $ sudo -u jenkins ssh git@github.com

Jenkins on Ubuntu 14LTS
#OpenJDK 7+ install
$ sudo add-apt-repository ppa:openjdk-r/ppa
$ sudo apt-get update
$ sudo apt-get install openjdk-8-jdk #<---JRE-only then openjdk-8-jre
  #defauld JVM config
  $ sudo update-alternatives --config java
  $ sudo update-alternatives --config javac
  $ java -version

# Jenkins install
$ wget -q -O - https://pkg.jenkins.io/debian/jenkins-ci.org.key | sudo apt-key add -
$ sudo sh -c 'echo deb http://pkg.jenkins.io/debian-stable binary/ > /etc/apt/sources.list.d/jenkins.list'
$ sudo apt-get update
$ sudo apt-get install jenkins
$ sudo service jenkins stop
$ sudo cat /var/lib/jenkins/secrets/initialAdminPassword
　384f2a96f00f4a73b5a1c6f0f9951993
$ sudo vim /var/lib/jenkins/hudson.model.UpdateCenter.xml
  <url>http://updates.jenkins.io/update-center.json</url> にする。httpsをhttpに変更。
  #そのほかの設定は　/etc/default/jenkinsを編集します。

$ sudo service jenkins start #TODO 
# w3m http://localhost:8080    
  #admin password
  $ sudo cat /var/lib/jenkins/secrets/initialAdminPassword

#開始停止など
$ sudo service jenkins status

#推奨プラグイン:時として手作業インストール
  #  Credentials Plugin
  #    Git  Pugin
  #    Git client plugin
  #   GitHub Branch Source Plugin
  #   SSH Slaves plugin
  #   Hudson Post build task
  #   Timestamper
  #   Workspace Cleanup Plugin

  #  Pipeline: SCM Step
  #   Stage View Plugin 
  #     handlebars
  #       Pipeline
  # Ubuntu 14LTS
    #Hudson Post build task
    #Conditional BuildStep 
    #Build Pipeline Plugin

  # NOTE: ダウンロードして再起動後にインストールをチェックするのが無難。円滑 
  # インストール後は認証情報：http://localhost:8081/credentials/store/system/domain/_/ 設定
#推奨プラグイン以外のもの
  #　Environment Injector Plugin

#Q&A
  # error: The requested URL returned error: 401 Unauthorized while accessing https://git.example.or
  # ===> git のリポジトリーURLを https://_user:_pass@git.example.org/git/***repo_name*** にする 
  #
  #


# プロジェクトごとの設定
#   windowsバッチのコマンドはfullpathで指定。コンテナ内部ではDOS環境みたいなPATHが設定されていない
#

#jobごとの設定：UNIXからの移植
  #echo "＃＃＃＃ KARMA TEST ＃＃＃"
  #cd C:\Users\some_body\Downloads\src\ris-front
  #
  REM "## %APPDATA\npm\ ---> Jenkinsの内部からはC:\Windows\system32\config\systemprofile\AppData\Roaming\npm と解釈されるので、npm installしたモジュールの場所は認識されない。"x"
  REM "## だからnpm installしたnodeモジュールをコマンド実行させたければ、フルパスで記述すること；"
  #c:\Users\some_body\AppData\Roaming\npm\webpack
  #c:\Users\some_body\AppData\Roaming\npm\karma start
